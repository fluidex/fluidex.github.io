<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.9a5d2afd2dfd940cbcc7.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{color:#e3eaf2;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#3c526d}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#111b27}:not(pre)>code[class*=language-]{padding:.1em .3em;border-radius:.3em;white-space:normal;color:#333;background:silver}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8da1b9}.token.punctuation{color:#e3eaf2}.token.delimiter.important,.token.selector .parent,.token.tag,.token.tag .token.punctuation{color:#6cc}.token.attr-name,.token.boolean,.token.boolean.important,.token.constant,.token.number,.token.selector .token.attribute{color:#e6d37a}.token.class-name,.token.key,.token.parameter,.token.property,.token.property-access,.token.variable{color:#6cb8e6}.token.attr-value,.token.color,.token.inserted,.token.selector .token.value,.token.string,.token.string .token.url-link{color:#91d076}.token.builtin,.token.keyword-array,.token.package,.token.regex{color:#f4adf4}.token.function,.token.selector .token.class,.token.selector .token.id{color:#c699e3}.token.atrule .token.rule,.token.combinator,.token.keyword,.token.operator,.token.pseudo-class,.token.pseudo-element,.token.selector,.token.unit{color:#e9ae7e}.token.deleted,.token.important{color:#cd6660}.token.keyword-this,.token.this{color:#6cb8e6}.token.bold,.token.important,.token.keyword-this,.token.this{font-weight:700}.token.delimiter.important{font-weight:inherit}.token.italic{font-style:italic}.token.entity{cursor:help}.language-markdown .token.title,.language-markdown .token.title .token.punctuation{color:#6cb8e6;font-weight:700}.language-markdown .token.blockquote.punctuation{color:#f4adf4}.language-markdown .token.code{color:#6cc}.language-markdown .token.hr.punctuation{color:#6cb8e6}.language-markdown .token.url .token.content{color:#91d076}.language-markdown .token.url-link{color:#e6d37a}.language-markdown .token.list.punctuation{color:#f4adf4}.language-json .token.operator,.language-markdown .token.table-header{color:#e3eaf2}.language-scss .token.variable{color:#6cc}.token.cr:before,.token.lf:before,.token.space:before,.token.tab:not(:empty):before{color:#8da1b9}div.code-toolbar>.toolbar a,div.code-toolbar>.toolbar button{color:#111b27;background:#6cb8e6}div.code-toolbar>.toolbar a:focus,div.code-toolbar>.toolbar a:hover,div.code-toolbar>.toolbar button:focus,div.code-toolbar>.toolbar button:hover{color:#111b27;background:rgba(108,184,230,.8549019607843137);text-decoration:none}div.code-toolbar>.toolbar span,div.code-toolbar>.toolbar span:focus,div.code-toolbar>.toolbar span:hover{color:#111b27;background:#8da1b9}.line-highlight{background:rgba(60,82,109,.37254901960784315);background:linear-gradient(90deg,rgba(60,82,109,.37254901960784315) 70%,rgba(60,82,109,.3333333333333333))}.line-highlight:before,.line-highlight[data-end]:after{background-color:#8da1b9;color:#111b27;box-shadow:0 1px #3c526d}pre[id].linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:rgba(141,161,185,.09411764705882353)}.line-numbers .line-numbers-rows{border-right:1px solid #0b121b;background:rgba(11,18,27,.47843137254901963)}.line-numbers-rows>span:before{color:rgba(141,161,185,.8549019607843137)}.rainbow-braces .token.punctuation.brace-level-1,.rainbow-braces .token.punctuation.brace-level-5,.rainbow-braces .token.punctuation.brace-level-9{color:#e6d37a}.rainbow-braces .token.punctuation.brace-level-2,.rainbow-braces .token.punctuation.brace-level-6,.rainbow-braces .token.punctuation.brace-level-10{color:#f4adf4}.rainbow-braces .token.punctuation.brace-level-3,.rainbow-braces .token.punctuation.brace-level-7,.rainbow-braces .token.punctuation.brace-level-11{color:#6cb8e6}.rainbow-braces .token.punctuation.brace-level-4,.rainbow-braces .token.punctuation.brace-level-8,.rainbow-braces .token.punctuation.brace-level-12{color:#c699e3}pre.diff-highlight>code .token.deleted:not(.prefix),pre>code.diff-highlight .token.deleted:not(.prefix){background-color:rgba(205,102,96,.12156862745098039)}pre.diff-highlight>code .token.inserted:not(.prefix),pre>code.diff-highlight .token.inserted:not(.prefix){background-color:rgba(145,208,118,.12156862745098039)}.command-line-prompt{border-right:1px solid #0b121b}.command-line-prompt>span:before{color:rgba(141,161,185,.8549019607843137)}</style><meta name="generator" content="Gatsby 3.0.1"/><style data-styled="" data-styled-version="5.2.1">.dWGLst{margin-left:auto;margin-right:auto;max-width:1300px;padding-left:var(--size-700);padding-right:var(--size-700);height:100%;}/*!sc*/
@media screen and (max-width:1000px){.dWGLst{padding-left:var(--size-400);padding-right:var(--size-400);}}/*!sc*/
data-styled.g1[id="container__Container-g6pcgm-0"]{content:"dWGLst,"}/*!sc*/
.hUaVNz{padding-top:var(--size-300);}/*!sc*/
data-styled.g2[id="header__StyledHeader-sc-1344zpp-0"]{content:"hUaVNz,"}/*!sc*/
.kTLBWK{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}/*!sc*/
data-styled.g3[id="header__HeaderWrapper-sc-1344zpp-1"]{content:"kTLBWK,"}/*!sc*/
.ljBqLG a{text-transform:uppercase;-webkit-text-decoration:none;text-decoration:none;font-size:var(--size-400);color:inherit;}/*!sc*/
data-styled.g4[id="header__HeaderTitle-sc-1344zpp-2"]{content:"ljBqLG,"}/*!sc*/
.gMMtgi{position:static;padding:0;background:transparent;-webkit-backdrop-filter:unset;backdrop-filter:unset;}/*!sc*/
data-styled.g5[id="header__StyledNav-sc-1344zpp-3"]{content:"gMMtgi,"}/*!sc*/
.lcjsVP{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:space-around;-webkit-justify-content:space-around;-ms-flex-pack:space-around;justify-content:space-around;padding:0;list-style-type:none;}/*!sc*/
data-styled.g6[id="header__StyledNavList-sc-1344zpp-4"]{content:"lcjsVP,"}/*!sc*/
.estiEP:not(:last-of-type){margin-right:2rem;}/*!sc*/
@media screen and (max-width:700px){.estiEP:not(:last-of-type){margin-right:1rem;}}/*!sc*/
.estiEP a{color:inherit;text-transform:uppercase;font-size:var(--size-300);-webkit-text-decoration:none;text-decoration:none;-webkit-letter-spacing:0.1rem;-moz-letter-spacing:0.1rem;-ms-letter-spacing:0.1rem;letter-spacing:0.1rem;}/*!sc*/
@media screen and (max-width:700px){.estiEP a{font-size:0.7rem;}}/*!sc*/
data-styled.g7[id="header__StyledNavListItem-sc-1344zpp-5"]{content:"estiEP,"}/*!sc*/
.elPAeh{padding:0;list-style:none;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/*!sc*/
data-styled.g8[id="social-links__SocialLinkList-r9vd8i-0"]{content:"elPAeh,"}/*!sc*/
.PkigP{margin-right:var(--size-400);text-transform:uppercase;}/*!sc*/
.PkigP a{color:inherit;font-size:var(--size-300);}/*!sc*/
data-styled.g9[id="social-links__SocialLinkItem-r9vd8i-1"]{content:"PkigP,"}/*!sc*/
.bXLsAg{padding-top:var(--size-300);padding-bottom:var(--size-300);}/*!sc*/
data-styled.g10[id="footer__StyledFooter-sc-1d6x338-0"]{content:"bXLsAg,"}/*!sc*/
.kzqyOn{font-size:var(--size-300);}/*!sc*/
.kzqyOn a{color:inherit;}/*!sc*/
data-styled.g11[id="footer__FooterAttribution-sc-1d6x338-1"]{content:"kzqyOn,"}/*!sc*/
.iWYEYe{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
data-styled.g12[id="footer__FooterWrapper-sc-1d6x338-2"]{content:"iWYEYe,"}/*!sc*/
*,*::before,*::after{box-sizing:border-box;}/*!sc*/
body,h1,h2,h3,h4,p,figure,blockquote,dl,dd{margin:0;}/*!sc*/
ul[role='list'],ol[role='list']{list-style:none;}/*!sc*/
html:focus-within{-webkit-scroll-behavior:smooth;-moz-scroll-behavior:smooth;-ms-scroll-behavior:smooth;scroll-behavior:smooth;}/*!sc*/
html{height:-webkit-fill-available;}/*!sc*/
body{min-height:100vh;min-height:-webkit-fill-available;text-rendering:optimizeSpeed;line-height:1.5;}/*!sc*/
a:not([class]){-webkit-text-decoration-skip-ink:auto;text-decoration-skip-ink:auto;}/*!sc*/
img,picture{max-width:100%;display:block;}/*!sc*/
input,button,textarea,select{font:inherit;}/*!sc*/
@media (prefers-reduced-motion:reduce){html:focus-within{-webkit-scroll-behavior:auto;-moz-scroll-behavior:auto;-ms-scroll-behavior:auto;scroll-behavior:auto;}*,*::before,*::after{-webkit-animation-duration:0.01ms !important;animation-duration:0.01ms !important;-webkit-animation-iteration-count:1 !important;animation-iteration-count:1 !important;-webkit-transition-duration:0.01ms !important;transition-duration:0.01ms !important;-webkit-scroll-behavior:auto !important;-moz-scroll-behavior:auto !important;-ms-scroll-behavior:auto !important;scroll-behavior:auto !important;}}/*!sc*/
html{width:100vw;overflow-x:hidden;}/*!sc*/
body::-webkit-scrollbar{width:10px;}/*!sc*/
body::-webkit-scrollbar-thumb{background-color:rgba(55,41,44,.4);}/*!sc*/
body::-webkit-scrollbar-track{background:#aaa;}/*!sc*/
:root{--size-300:0.75rem;--size-400:1rem;--size-500:1.33rem;--size-600:1.77rem;--size-700:2.36rem;--size-800:3.15rem;--size-900:4.2rem;}/*!sc*/
body{font-family:'Poppins',-apple-system,BlinkMacSystemFont,avenir next,avenir,helvetica neue, helvetica,Ubuntu,roboto,noto,segoe ui,arial,sans-serif;color:#37292C;background-attachment:fixed;background-color:#d9e4f5;background-image:linear-gradient(315deg,#d9e4f5 0%,#f5e3e6 74%);}/*!sc*/
h1,h2,h3,h4{line-height:1.125;}/*!sc*/
h1,h2,h3{font-weight:700;}/*!sc*/
h1{font-size:var(--size-800);}/*!sc*/
h2{font-size:var(--size-700);}/*!sc*/
h3{font-size:var(--size-600);}/*!sc*/
p{font-size:var(--size-400);}/*!sc*/
::selection{background:rgba(255,255,255,0.9);}/*!sc*/
p,li{max-width:none;}/*!sc*/
.gatsby-resp-image-wrapper{margin-left:0 !important;}/*!sc*/
data-styled.g13[id="sc-global-dqoMdz1"]{content:"sc-global-dqoMdz1,"}/*!sc*/
.cKBEjL{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}/*!sc*/
.cKBEjL main{margin-top:auto;margin-bottom:auto;}/*!sc*/
.cKBEjL footer{margin-top:auto;}/*!sc*/
data-styled.g14[id="layout__LayoutWrapper-qrswv8-0"]{content:"cKBEjL,"}/*!sc*/
.gGPpxa{margin-right:0.6rem;margin-bottom:0.6rem;text-transform:uppercase;font-size:var(--size-300);}/*!sc*/
.gGPpxa a{position:relative;z-index:2;background-color:rgba(255,255,255,0.7);-webkit-text-decoration:none;text-decoration:none;color:inherit;padding:0.2rem 0.6rem;border:1px solid rgba(255,255,255,1);border-radius:4px;}/*!sc*/
.gGPpxa a:hover{background-color:rgba(255,255,255,0.9);}/*!sc*/
data-styled.g16[id="tags__Tag-sc-16itk8x-0"]{content:"gGPpxa,"}/*!sc*/
.jLVknC{padding-top:var(--size-900);padding-bottom:var(--size-900);margin-left:auto;margin-right:auto;max-width:70ch;word-wrap:break-word;}/*!sc*/
data-styled.g39[id="post-template__PostWrapper-afk1br-0"]{content:"jLVknC,"}/*!sc*/
.jvERbU{font-size:var(--size-700);}/*!sc*/
data-styled.g40[id="post-template__PostTitle-afk1br-1"]{content:"jvERbU,"}/*!sc*/
.ijlCjX{font-size:var(--size-400);padding-top:1rem;text-transform:uppercase;}/*!sc*/
data-styled.g41[id="post-template__PostDate-afk1br-2"]{content:"ijlCjX,"}/*!sc*/
.dEfyJD{padding-top:var(--size-800);}/*!sc*/
.dEfyJD > * + *{margin-top:var(--size-300);}/*!sc*/
.dEfyJD > p + p{margin-top:var(--size-700);}/*!sc*/
.dEfyJD * + h1,.dEfyJD * + h2,.dEfyJD * + h3{margin-top:var(--size-900);}/*!sc*/
.dEfyJD h1{font-size:var(--size-700);}/*!sc*/
.dEfyJD h2{font-size:var(--size-600);}/*!sc*/
.dEfyJD h3{font-size:var(--size-500);}/*!sc*/
.dEfyJD b,.dEfyJD strong{font-weight:600;}/*!sc*/
.dEfyJD a{color:inherit;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration-thickness:0.125rem;text-decoration-thickness:0.125rem;}/*!sc*/
.dEfyJD blockquote{padding-left:var(--size-400);border-left:5px solid;font-style:italic;}/*!sc*/
.dEfyJD code{font-family:"Source Sans Pro",monospace;overflow-x:auto;white-space:pre-wrap;}/*!sc*/
.dEfyJD pre{overflow-x:auto;white-space:pre-wrap;max-width:100%;}/*!sc*/
data-styled.g42[id="post-template__PostContent-afk1br-3"]{content:"dEfyJD,"}/*!sc*/
.ijTjwt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:var(--size-900);}/*!sc*/
.ijTjwt > *{position:relative;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:1rem;padding-top:0.5rem;padding-bottom:0.5rem;border-radius:8px;border:1px solid rgba(255,255,255,0.5);background-color:rgba(255,255,255,0.3);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);margin:0.5rem;}/*!sc*/
.ijTjwt > *:hover{background-color:rgba(255,255,255,0.5);}/*!sc*/
.ijTjwt span{text-transform:uppercase;opacity:0.6;font-size:var(--size-400);padding-bottom:var(--size-500);}/*!sc*/
.ijTjwt a{color:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:var(--size-400);text-transform:capitalize;}/*!sc*/
.ijTjwt a::after{content:"";position:absolute;left:0;right:0;top:0;bottom:0;}/*!sc*/
data-styled.g43[id="post-template__PostPagination-afk1br-4"]{content:"ijTjwt,"}/*!sc*/
</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{all:inherit;bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro|Poppins:400,400i,700&amp;display=swap" rel="stylesheet"/><link rel="icon" href="/favicon-32x32.png?v=a9c34c9cfad998e9d71d69da79e233c6" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a9c34c9cfad998e9d71d69da79e233c6"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a9c34c9cfad998e9d71d69da79e233c6"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a9c34c9cfad998e9d71d69da79e233c6"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a9c34c9cfad998e9d71d69da79e233c6"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a9c34c9cfad998e9d71d69da79e233c6"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a9c34c9cfad998e9d71d69da79e233c6"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a9c34c9cfad998e9d71d69da79e233c6"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a9c34c9cfad998e9d71d69da79e233c6"/><title>Differential AMM: a highly flexible AMM algorithm based on micro indicators - Fluidex</title><meta name="description" content="Automatic Market-Making (AMM) strategies are usually defined by macro indicators. Macro indicators refer to indicators that describe the total amount, including…"/><meta property="og:title" content="Differential AMM: a highly flexible AMM algorithm based on micro indicators"/><meta property="og:description" content="Automatic Market-Making (AMM) strategies are usually defined by macro indicators. Macro indicators refer to indicators that describe the total amount, including…"/><meta property="og:type" content="website"/><meta property="og:image" content="https://raw.githubusercontent.com/Fluidex/fluidex.github.io/master/static/media/square.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="fluid_dex"/><meta name="twitter:title" content="Differential AMM: a highly flexible AMM algorithm based on micro indicators"/><meta name="twitter:description" content="Automatic Market-Making (AMM) strategies are usually defined by macro indicators. Macro indicators refer to indicators that describe the total amount, including…"/><meta name="twitter:image" content="https://raw.githubusercontent.com/Fluidex/fluidex.github.io/master/static/media/wide.png"/><link as="script" rel="preload" href="/webpack-runtime-a6a05c14793d7c0627b7.js"/><link as="script" rel="preload" href="/framework-6eebe74f6e3ca2e4baa9.js"/><link as="script" rel="preload" href="/app-7c8f269066a56f83f0b7.js"/><link as="script" rel="preload" href="/commons-5ee680bf8998dc89a339.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-a76bda2642029ae4f2bc.js"/><link as="fetch" rel="preload" href="/page-data/en/blog/damm/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2555585279.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3159585216.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout__LayoutWrapper-qrswv8-0 cKBEjL"><header class="header__StyledHeader-sc-1344zpp-0 hUaVNz"><div class="container__Container-g6pcgm-0 header__HeaderWrapper-sc-1344zpp-1 dWGLst kTLBWK"><div class="header__HeaderTitle-sc-1344zpp-2 ljBqLG"><a href="/en/index">Fluidex</a></div><nav class="header__StyledNav-sc-1344zpp-3 gMMtgi"><ul class="header__StyledNavList-sc-1344zpp-4 lcjsVP"><li class="header__StyledNavListItem-sc-1344zpp-5 estiEP"><a href="/en/blog">Blog</a></li><li class="header__StyledNavListItem-sc-1344zpp-5 estiEP"><a href="/en/about">About</a></li><li class="header__StyledNavListItem-sc-1344zpp-5 estiEP"><a href="/en/contact">Contact</a></li><li class="header__StyledNavListItem-sc-1344zpp-5 estiEP"><style data-emotion="css 2b097c-container">.css-2b097c-container{position:relative;box-sizing:border-box;}</style><div class=" css-2b097c-container"><style data-emotion="css 7pg0cj-a11yText">.css-7pg0cj-a11yText{z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap;}</style><span aria-live="polite" aria-atomic="false" aria-relevant="additions text" class="css-7pg0cj-a11yText"></span><style data-emotion="css ib73kg-control">.css-ib73kg-control{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:hsl(0, 0%, 100%);border-color:hsl(0, 0%, 80%);border-radius:4px;border-style:solid;border-width:1px;cursor:default;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;min-height:38px;outline:0!important;position:relative;-webkit-transition:all 100ms;transition:all 100ms;box-sizing:border-box;height:35px;width:150px;}.css-ib73kg-control:hover{border-color:hsl(0, 0%, 70%);}</style><div class=" css-ib73kg-control"><style data-emotion="css 1hwfws3">.css-1hwfws3{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:2px 8px;-webkit-overflow-scrolling:touch;position:relative;overflow:hidden;box-sizing:border-box;}</style><div class=" css-1hwfws3"><style data-emotion="css 1uccc91-singleValue">.css-1uccc91-singleValue{color:hsl(0, 0%, 20%);margin-left:2px;margin-right:2px;max-width:calc(100% - 8px);overflow:hidden;position:absolute;text-overflow:ellipsis;white-space:nowrap;top:50%;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);box-sizing:border-box;}</style><div class=" css-1uccc91-singleValue"><div style="display:flex">English</div></div><style data-emotion="css 1g6gooi">.css-1g6gooi{margin:2px;padding-bottom:2px;padding-top:2px;visibility:visible;color:hsl(0, 0%, 20%);box-sizing:border-box;}</style><div class="css-1g6gooi"><div class="" style="display:inline-block"><input type="text" autoCapitalize="none" autoComplete="off" autoCorrect="off" id="react-select-13-input" spellcheck="false" tabindex="0" value="" aria-autocomplete="list" style="box-sizing:content-box;width:1px;label:input;background:0;border:0;font-size:inherit;opacity:1;outline:0;padding:0;color:inherit"/><div style="position:absolute;top:0;left:0;visibility:hidden;height:0;overflow:scroll;white-space:pre"></div></div></div></div><style data-emotion="css 1wy0on6">.css-1wy0on6{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;box-sizing:border-box;}</style><div class=" css-1wy0on6"><style data-emotion="css 1okebmr-indicatorSeparator">.css-1okebmr-indicatorSeparator{-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;background-color:hsl(0, 0%, 80%);margin-bottom:8px;margin-top:8px;width:1px;box-sizing:border-box;}</style><span class=" css-1okebmr-indicatorSeparator"></span><style data-emotion="css tlfecz-indicatorContainer">.css-tlfecz-indicatorContainer{color:hsl(0, 0%, 80%);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:8px;-webkit-transition:color 150ms;transition:color 150ms;box-sizing:border-box;}.css-tlfecz-indicatorContainer:hover{color:hsl(0, 0%, 60%);}</style><div class=" css-tlfecz-indicatorContainer" aria-hidden="true"><style data-emotion="css 8mmkcg">.css-8mmkcg{display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0;}</style><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-8mmkcg"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div></div></li></ul></nav></div></header><main><div class="container__Container-g6pcgm-0 dWGLst"><div class="post-template__PostWrapper-afk1br-0 jLVknC"><article><h1 class="post-template__PostTitle-afk1br-1 jvERbU">Differential AMM: a highly flexible AMM algorithm based on micro indicators</h1><span class="post-template__PostDate-afk1br-2 ijlCjX">May 19, 2021</span><section class="post-template__PostContent-afk1br-3 dEfyJD"><p>Automatic Market-Making (AMM) strategies are usually defined by macro indicators. Macro indicators refer to indicators that describe the total amount, including the base amount (BA) and the quote amount (QA) of the trading tokens in the AMM pool. For example, the most common AMM algorithm - the Constant Product Algorithm - requires the product of BA and QA to be equal both before and after each transaction. But in fact, for a real-world trader, micro indicators are more informative for each trade decision making. Micro indicators refer to indicators that characterize market changes, or marginal effects of transactions, such as current market price and market depth. The market price describes the average deal price of a relatively small-volume transaction in the current state, and the market depth describes the largest potential trading volume within an offered price. In plain language, assume that the price of ETH is now 3450 USDT, if I want to buy as much ETH as possible at a price not exceeding 3451, the amount of ETH I could buy can be regarded as the market depth.</p>
<p>From the orderbook perspective, both price and depth are more intuitive than macro indicators. We here try to design a better AMM algorithm based on these two micro indicators. </p>
<h1>Mathematical Background - The relationship between macro and micro indicators</h1>
<p>In this section, we will explain the relationship between the micro indicators (price and depth) and the base/quote amount (pool size). As we will see, the formulas of price and depth can both be derived from the base/quote amount formulas by several derivative/inverse function transformations.</p>
<p>Assume that base amount and quote amount in AMM pool satisfy the following relationship:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">quote = f(base)</code></pre></div>
<p>Obviously, we have quote > 0, base > 0. f is monotonically decreasing, i.e., f’ &#x3C; 0 (as in each trade in an AMM pool, a token is turned into another token; if the amount of one token increases, the other will of course decrease).</p>
<p>By definition, price is the absolute value of the derivative of f (as f’ is negative, it’s actually the reverse value of f’):</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">price = abs(f&#39;(base)) = -f&#39;(base)</code></pre></div>
<p>Normally we require the price, -f’, to be monotonically decreasing, i.e., the smaller the base amount, the higher the price. Thus, f” > 0. In a word, a reasonable f should be: a convex downward and monotonically decreasing function defined in the first quadrant.</p>
<p>Correspondingly, market depth is actually the derivative of base amount w.r.t. price.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">depth = f2&#39;(price)
f2 = Inverse(f&#39;) </code></pre></div>
<p>Where <code class="language-text">Inverse</code> means inverse function.</p>
<p>In the above formula, f2 is the inverse function of the price function, and its derivative is the function of depth w.r.t. price.</p>
<p>That concludes the relationship between market price/depth and base/quote function.</p>
<h1>Mathematical Background - Solving</h1>
<p>For a creator of AMM pool, they care the most about the initial price (price0) and initial depth (depth0). From mathematic perspective, they need to give an AMM function of the form <code class="language-text">quote = f(base)</code>, so that there’s a coordinate satisfying <code class="language-text">price = price0</code> and <code class="language-text">depth = depth0</code>.</p>
<p>In other words, they need to solve the following equation:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Given depth0, price0,
f is the function describing the relationship between base and quote amount, quote = f(base). Find a f that satisfies:

* There&#39;s base0, such that f&#39;(base0) = price0
* (Inverse(f&#39;))&#39;(price0) = depth0

Additionally, it&#39;s required that f &gt; 0, f&#39; &lt; 0 and f&#39;&#39; &gt; 0, that is, f is a convex downward and monotonically decreasing function defined in the first quadrant.</code></pre></div>
<p>Actually, as the above equations has too few constraints, there are infinite number of solutions. f could be a reciprocal function, a more general hyperbolic function, an exponential function, or a power function. However in the next section, we will see that if we specify a certain form of f and limit its coefficients, we may be able to determine a unique solution.</p>
<h3>One of the solutions - when f is a translated reciprocal function</h3>
<p>If f is a reciprocal function in form of:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">quote = f(base) = C / (base + BASE_DELTA) - QUOTE_DELTA </code></pre></div>
<p>Or equivalantly, using multiple variables:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">vQuote = C / vBase
vQoute = quote + QUOTE_DELTA
vBase = base + BASE_DELTA</code></pre></div>
<p>where <code class="language-text">C</code>, <code class="language-text">BASE_DELTA</code>, <code class="language-text">QUOTE_DELTA</code> are positive constants.</p>
<p>When f is in this form, the price and depth could be derived as:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">price = -f&#39;(base) = C / (vBase**2) = vQuote / vBase
depth = vBase**2 / (2 * vQuote)</code></pre></div>
<p>According to the condition that at <code class="language-text">price0</code>, the depth is <code class="language-text">depth0</code>, it can be solved as:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">C = vBase0 * vQuote0 = 4 * price0**3 * depth0**2
vQuote0 = 2 * price0**2 * depth0 = quote0 + QUOTE_DELTA
vBase0 = 2 * price0 * depth0 = base0 + BASE_DELTA</code></pre></div>
<p>So finally, the AMM function <code class="language-text">quote = f(base)</code> will be:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">quote = f(base) = C / (base + BASE_DELTA) - QUOTE_DELTA,</code></pre></div>
<p>where <code class="language-text">C = 4 * price0**3 * depth0**2</code>, <code class="language-text">BASE_DELTA</code> and <code class="language-text">QUOTE_DELTA</code> are random constants.</p>
<p>To conclude, we demonstrated that if specifying f as an reciprocal function, an unique solution of f could be obtained from price and depth. Although f can actually be any types of functions, for simplicity and without the loss of generality, we will use reciprocal function as our AMM function in the rest of the post.</p>
<h1>Formula definition of Differential AMM</h1>
<p>Synthesizing all the derivations in the previous section, we can get the complete definition of Differential AMM:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">quote = f(base) = C / (base + BASE_DELTA) - QUOTE_DELTA</code></pre></div>
<p>Terminology:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>price0</td>
<td>initial market price</td>
</tr>
<tr>
<td>depth0</td>
<td>initial market depth</td>
</tr>
<tr>
<td>lowPrice</td>
<td>the lowest automatic market-making price, minimum is 0</td>
</tr>
<tr>
<td>highPrice</td>
<td>the highest automatic market-making price, maximum is positive inifinite</td>
</tr>
<tr>
<td>quote0</td>
<td>initial actual quote amount</td>
</tr>
<tr>
<td>base0</td>
<td>initial actual base amount</td>
</tr>
<tr>
<td>QUOTE_DELTA</td>
<td>virtual quote amount</td>
</tr>
<tr>
<td>BASE_DELTA</td>
<td>virtual base amount</td>
</tr>
<tr>
<td>C</td>
<td>constant product</td>
</tr>
<tr>
<td>vQoute0</td>
<td>initial total quote amount, including actual and virtual</td>
</tr>
<tr>
<td>vBase0</td>
<td>initial total base amount, including actual and virtual</td>
</tr>
</tbody>
</table>
<p>Relationships between the parameters:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(1) C = 4 * price0**3 * depth0**2
(2) lowPrice = QUOTE_DELTA**2 / C
(3) highPrice = C / BASE_DELTA**2
(4) price0 = vQuote0 / vBase0
(5) depth0 = vBase**2 / (2 * vQuote)
(6) vQoute0 = 2 * price0**2 * depth0
(7) vBase0 = 2 * price0 * depth0
(8) vQoute0 = quote0 + QUOTE_DELTA
(9) vBase0 = base0 + BASE_DELTA</code></pre></div>
<p>Note1: Among the above formulas, (4)(5) and (6)(7) are equivalant.</p>
<p>Note2: With the same <code class="language-text">price0</code> and <code class="language-text">depth0</code>, the smaller <code class="language-text">QUOTE_DELTA</code> and <code class="language-text">BASE_DELTA</code> are, the larger <code class="language-text">base0</code> and <code class="language-text">quote0</code> are. That is, when providing the same market liquidity, a greater amount of fund will lead to a lower so-called “capital efficiency”, but a wider market-making price range (i.e., from <code class="language-text">lowPrice</code> to <code class="language-text">highPrice</code>). Extremely, when <code class="language-text">QUOTE_DELTA</code> and <code class="language-text">BASE_DELTA</code> are both 0, <code class="language-text">lowPrice</code> will be 0 and <code class="language-text">highPrice</code> will be inifinite. In this situation, DAMM degenerates into Constant Product AMM. We could adjust capital efficiency arbitrarily by adjusting <code class="language-text">lowPrice</code> and <code class="language-text">highPrice</code>.</p>
<p>In reality, for the following 3 groups of parameters, (A) depth price, (B) lowPrice highPrice, (C) quote0 base0, given any two groups, the third group, as well as the complete market-making function could be derived.</p>
<p>Here are the three scenarios corresponding to three initial conditions:</p>
<h3>Given price and depth (A), and initial amounts (C)</h3>
<p>That is, in the equations, given <code class="language-text">price0</code>, <code class="language-text">depth0</code>, and <code class="language-text">quote0</code>, <code class="language-text">base0</code>, we then want to calculate market-making price range and other parameters.</p>
<p>For step-by-step solution please refer to: <a href="https://github.com/Fluidex/differential-amm/blob/673b2801c822bc5e75dc63f1def0204b8d57bb03/main.ts#L39">https://github.com/Fluidex/differential-amm/blob/673b2801c822bc5e75dc63f1def0204b8d57bb03/main.ts#L39</a></p>
<h3>Given price and depth (A), and market-making price range (B)</h3>
<p>That is, in the equations, given <code class="language-text">price0</code>, <code class="language-text">depth0</code>, and <code class="language-text">lowPrice</code> (could be 0), <code class="language-text">highPrice</code> (could be inifinity), need to calculate initial amount and other parameters.</p>
<p>For step-by-step solution please refer to: <a href="https://github.com/Fluidex/differential-amm/blob/673b2801c822bc5e75dc63f1def0204b8d57bb03/main.ts#L53">https://github.com/Fluidex/differential-amm/blob/673b2801c822bc5e75dc63f1def0204b8d57bb03/main.ts#L53</a></p>
<h3>Given market-making price range (B), and initial amounts (C)</h3>
<p>This is the most complex scenario. Actually it is equivalant to solving a binary quadratic equation. By solving the equation we could get all other parameters.</p>
<p>For step-by-step solution please refer to: <a href="https://github.com/Fluidex/differential-amm/blob/673b2801c822bc5e75dc63f1def0204b8d57bb03/main.ts#L72">https://github.com/Fluidex/differential-amm/blob/673b2801c822bc5e75dc63f1def0204b8d57bb03/main.ts#L72</a></p>
<p>From the above three scenarios, we could see that DAMM has great flexibility. On the one hand, different scenarios may have different requirements and different initial conditions. Under the above three initial conditions, we are still able to solve a correct DAMM strategy. On the other hand, <strong>we can abitrarily adjust capital efficiency through the price range or initial amount</strong>.</p>
<h1>Miscellaneous</h1>
<h2>Converting AAM to orderbook</h2>
<p>By approximating the AMM curve section by section, we can get a discretized orderbook. In our <a href="https://github.com/Fluidex/differential-amm/blob/673b2801c822bc5e75dc63f1def0204b8d57bb03/main.ts#L156">reference implementation</a>, we could specify price interval and the number of orders, and get order size and average price by calculating BASE<em>DELTA and QUOTE</em>DELTA.</p>
<h2>Mathematical equivalance</h2>
<p>It’s easy to see that DAMM is mathematically equivalant to the market maker algorithm (x + a)(y + b) = k. The difference is that we interpret it in a micro perspective way, as well as possibilities to solve from different initial conditions.</p></section></article><nav class="post-template__PostPagination-afk1br-4 ijTjwt"><div><span>previous</span><a href="/en/blog/2021-05-27-updates/"> <!-- -->Fluidex March Updates</a></div><div><span>next</span><a href="/en/blog/zkrollup-intro1/"> <!-- -->ZK-Rollup development experience sharing, Part I</a></div></nav><div><span class="tags__Tag-sc-16itk8x-0 gGPpxa"><a href="/en/tags/technical">technical</a></span></div></div></div></main><footer class="footer__StyledFooter-sc-1d6x338-0 bXLsAg"><div class="container__Container-g6pcgm-0 footer__FooterWrapper-sc-1d6x338-2 dWGLst iWYEYe"><ul class="social-links__SocialLinkList-r9vd8i-0 elPAeh"><li class="social-links__SocialLinkItem-r9vd8i-1 PkigP"><a href="https://github.com/Fluidex">github</a></li><li class="social-links__SocialLinkItem-r9vd8i-1 PkigP"><a href="https://t.me/fluid_dex">telegram</a></li><li class="social-links__SocialLinkItem-r9vd8i-1 PkigP"><a href="https://twitter.com/fluid_dex">twitter</a></li><li class="social-links__SocialLinkItem-r9vd8i-1 PkigP"><a href="https://fluid-dex.medium.com/">medium</a></li></ul><p class="footer__FooterAttribution-sc-1d6x338-1 kzqyOn">Copyright © 2021 Team Fluidex. All rights reserved.</p></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/en/blog/damm/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-09f2335fbd5439b3b0a4.js"],"app":["/app-7c8f269066a56f83f0b7.js"],"component---src-pages-404-index-en-js":["/component---src-pages-404-index-en-js-16ceaae0911b41f14c1e.js"],"component---src-pages-404-index-zh-js":["/component---src-pages-404-index-zh-js-7e6361be422b66748607.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a7e3873d2c07695ebe7f.js"],"component---src-pages-blog-index-en-js":["/component---src-pages-blog-index-en-js-be6f5fc752e3f7126a8b.js"],"component---src-pages-blog-index-zh-js":["/component---src-pages-blog-index-zh-js-ac32559f6f328ee936d9.js"],"component---src-pages-tags-index-en-js":["/component---src-pages-tags-index-en-js-18bf4f8b00e73baaa355.js"],"component---src-pages-tags-index-zh-js":["/component---src-pages-tags-index-zh-js-1c258a3d7652941f954d.js"],"component---src-templates-about-template-js":["/component---src-templates-about-template-js-ab4b7e3b7c1c79e0b1ad.js"],"component---src-templates-contact-template-js":["/component---src-templates-contact-template-js-e8fbc5656f02270afd1c.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-c767791e3b32c1b5c9d6.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-a76bda2642029ae4f2bc.js"],"component---src-templates-tags-template-js":["/component---src-templates-tags-template-js-590a4932fac61ecedc83.js"]};/*]]>*/</script><script src="/polyfill-09f2335fbd5439b3b0a4.js" nomodule=""></script><script src="/component---src-templates-post-template-js-a76bda2642029ae4f2bc.js" async=""></script><script src="/commons-5ee680bf8998dc89a339.js" async=""></script><script src="/app-7c8f269066a56f83f0b7.js" async=""></script><script src="/framework-6eebe74f6e3ca2e4baa9.js" async=""></script><script src="/webpack-runtime-a6a05c14793d7c0627b7.js" async=""></script></body></html>