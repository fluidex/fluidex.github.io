{"componentChunkName":"component---src-templates-post-template-js","path":"/zh/blog/introducing-plonkit/","result":{"data":{"markdownRemark":{"excerpt":"我们很高兴地宣布，FluiDex 的 plonkit 最近得到了以太坊基金会 ESP grant 的支持，我们将在这篇文章中介绍我们开发的这款零知识证明工具。 简介 Plonkit 是一款配合 Circom 使用的 PLONK 协议 零知识证明工具。Circom…","html":"<p>我们很高兴地宣布，FluiDex 的 <a href=\"https://github.com/fluidex/plonkit\">plonkit</a> 最近得到了以太坊基金会 <a href=\"https://blog.ethereum.org/2021/11/04/esp-allocation-update-q2-2021/\">ESP grant</a> 的支持，我们将在这篇文章中介绍我们开发的这款零知识证明工具。</p>\n<h2>简介</h2>\n<p>Plonkit 是一款配合 <a href=\"https://github.com/iden3/circom\">Circom</a> 使用的 <a href=\"https://eprint.iacr.org/2019/953.pdf\">PLONK 协议</a> 零知识证明工具。Circom 是一个开发者能轻易上手的零知识证明电路描述语言。Plonkit 目前支持了：生成 plonk 证明、验证 plonk 证明，以及生成验证合约以在 EVM 中进行验证。</p>\n<h2>plonkit 的源起</h2>\n<p><a href=\"https://eprint.iacr.org/2019/953.pdf\">PLONK</a> 目前是性能最好（证明时间、证明体积）的零知识证明协议之一。<a href=\"https://vitalik.ca/general/2019/09/22/plonk.html\">V 神在博客中解释道</a>，受益于 “universal and updateable” setup， PLONK 比起 <a href=\"https://eprint.iacr.org/2016/260.pdf\">Groth16</a> 更安全，但性能上又没有太大损失。</p>\n<p>但如果使用 C++/Rust/… 来编写零知识证明电路还是太麻烦，因为这需要编写大量的底层的约束。有一个思路可以解决这个问题，即使用 Circom 这门零知识证明电路 DSL 来开发电路。</p>\n<p>为了使开发者能轻松地编写电路并使用 plonk 协议，我们开发了 plonkit。<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<h2>plonkit 的功能</h2>\n<p>Plonkit 的功能包括：</p>\n<ul>\n<li>Structured-Reference-String (SRS) 的本地生成</li>\n<li>Verification Key 的生成</li>\n<li>Proof 的生成</li>\n<li>Proof 的验证</li>\n<li>生成验证合约</li>\n<li>证明聚合</li>\n</ul>\n<h3>Local SRS setup</h3>\n<p>想要导出一个 verification key 和生成 proof（具体见下文中的解释），我们需要一个 Structured-Reference-String。在 <a href=\"https://github.com/fluidex/plonkit/blob/master/test/test_poseidon_plonk.sh\">test_poseidon_plonk.sh</a> 中，我们提供了一个实现生成好的 SRS 的下载链接 <sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup>。据 <a href=\"https://github.com/matter-labs/bellman/blob/f551a55d83d2ea604b2dbfe096fd9dcfdaedb189/src/kate_commitment/mod.rs#L1090\">matter-labs</a>，这个是由 <a href=\"https://medium.com/aztec-protocol/aztec-announcing-our-ignition-ceremony-757850264cfe\">AZTEC 的 ignition setup</a> 解析而来。</p>\n<p>为了方便测试，我们添加了本地生成 SRS 的功能。</p>\n<h3>Verification Key 的生成</h3>\n<p>用户可以导出一个电路对应的 verification key。Verification key 需要在验证 proof 时使用。</p>\n<h3>Proof 的生成</h3>\n<p>用户可以生成一个 proof 来证明他知道能满足电路的信息。</p>\n<h3>Proof 的验证</h3>\n<p>Proof 的验证指的是使用电路对应的 verification key 来验证一个 proof。</p>\n<h3>生成验证合约</h3>\n<p>用户可以使用 plonkit 生成对一个电路的验证合约，这样就可以在 EVM 上验证一个 proof。</p>\n<h3>证明聚合</h3>\n<p>Plonkit 封装了 <a href=\"https://github.com/matter-labs/recursive_aggregation_circuit\">recursive_aggregation_circuit</a> 以支持证明聚合。核心思想是 <a href=\"https://eprint.iacr.org/2019/1021.pdf\">Halo</a> 这篇论文。证明聚合使得用户可以将多个证明压缩成一个，达到一个 proof 就能证明多个 proof 的效果。</p>\n<p>值得注意的是：</p>\n<ul>\n<li>由于以太坊虚拟机只支持 BN_254 一条曲线，所以我们无法像 Halo 中采用循环曲线，而是模拟了 base 域上的元素。</li>\n<li>我们并不是循环迭代层层聚合多个 proof，而是将多个 proof 一次性聚合起来，所以是一个深度为 1 的聚合。</li>\n<li>我们不直接在电路中验证 pairing，而是将群上的点聚合起来，在智能合约中再进行验证。</li>\n</ul>\n<h2>plonkit 的使用流程</h2>\n<p>下图展示了 plonkit 的使用流程：</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b83f1e0a8f618a8a753621d467492acf/7dd84/plonkit.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.87341772151899%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAD2EAAA9hAHVrK90AAACJUlEQVQoz01Sy4vSURQ+YxOIJOM0/YaKZtmQEtYsmiCFNmMRjS36AyqCGRI3Lgx0MTtBEREZxRciKKKiIj5ARcXH+AbxzagguFJCyUVtJIhf5wpFFy6H853Xd757IR6PM1KpFCMYDG7RNA25XA7W6zWYzWbIZrOMYrHIGA6H24vFArrdrq3dbtO9Xm8tkUgeVyqV15jzCgCYFEXtADnYENLpNEQiEUgkEhvs8vISHA4HYDOoVqtgsVhguVxCrVZ7gXkXmH+uVCo5Ho+H43a7d7HkJofDoQghCIVCR7FY7LnX6933+/1AQJ1OB1ar9RYOeJbJZI5dLteuQqGAcDi8iZMrFothPB5DIBAAjBMeTJPJBHB9ff0TA3Sz2bxA8IZUKmWjZTidzvfz+ZzGVWlcS0KaFAqF2yqV6kitVj8kvlAoBC6XC1qt9o5cLn9qMBjuEZ1OSqXSKep4QKgzmcxDtKxGo8HO5/NvUKe3yPQ+Yux6ve6czWb0dDr9hqu+7Pf7n1ksFoXaxlerFY3xHzAajb5jAl0ulxVYtC0QCPZJY9TwHTL/NZlMfuOwM8Iah/N9Pt8n1PHUaDTuIE6RGpTsGLEPyWTyBFqt1sfBYPAFhX7yVx9ybTbbQafTOUMW55h8SDCNRvMvLpPJADcDHo8HdrudaLiF7wGARURHsjr83xAZkG8COAyi0ShcXV1tfgCfz99DQ+n1+kcoy1eRSHQX/b0HeEjdH+dbR5RZJ2+cAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"plonkit\"\n        title=\"plonkit\"\n        src=\"/static/b83f1e0a8f618a8a753621d467492acf/f058b/plonkit.png\"\n        srcset=\"/static/b83f1e0a8f618a8a753621d467492acf/c26ae/plonkit.png 158w,\n/static/b83f1e0a8f618a8a753621d467492acf/6bdcf/plonkit.png 315w,\n/static/b83f1e0a8f618a8a753621d467492acf/f058b/plonkit.png 630w,\n/static/b83f1e0a8f618a8a753621d467492acf/40601/plonkit.png 945w,\n/static/b83f1e0a8f618a8a753621d467492acf/78612/plonkit.png 1260w,\n/static/b83f1e0a8f618a8a753621d467492acf/7dd84/plonkit.png 3732w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><a href=\"https://github.com/fluidex/plonkit/blob/master/test/test_poseidon_plonk.sh\">test_poseidon_plonk.sh</a> 脚本也是个很好的例子。</p>\n<h2>致谢</h2>\n<ul>\n<li>\n<p>Plonkit 基于 matter-labs 开发的以下几个库:</p>\n<ul>\n<li><a href=\"https://github.com/matter-labs/bellman\">bellman_ce</a></li>\n<li><a href=\"https://github.com/matter-labs/solidity_plonk_verifier\">solidity_plonk_verifier</a></li>\n<li><a href=\"https://github.com/matter-labs/recursive_aggregation_circuit\">recursive_aggregation_circuit</a></li>\n</ul>\n</li>\n<li>Plonkit 的 “R1CSFile reader” 部分源于 <a href=\"https://github.com/poma/zkutil\">zkUtil</a>.</li>\n<li>另外，<a href=\"https://github.com/iden3/circom\">Circom</a> 使得开发者能方便地编写零知识证明电路，这也是 plonkit 的基石之一。</li>\n</ul>\n<p>感谢这些伟大的工作。</p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>当我们开始开发 plonkit 时，Circom/snarkJS 还没支持 PLONK（<a href=\"https://blog.iden3.io/circom-snarkjs-plonk.html\">现已支持</a>）。plonkit 对比起 circom-snarkjs-plonk 会更高效（plonkit 采用 Rust 编写、 snarkJS 采用 JS 编写，而且我们的实现也不尽相同)，但 snarkJS 可以支持在浏览器中运行而 plonkit 暂时不能。</p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a>\n</li>\n<li id=\"fn-2\">\n<p>来源：<a href=\"https://github.com/matter-labs/zksync/blob/master/infrastructure/zk/src/run/run.ts#L77\">https://github.com/matter-labs/zksync/blob/master/infrastructure/zk/src/run/run.ts#L77</a></p>\n<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>","frontmatter":{"title":"plonkit","tags":["technical"],"date":"2021-10-19T20:00:00.000Z","description":null}},"prev":null,"next":{"frontmatter":{"title":"打磨第一个完全开源的 ZK-Rollup DEX: FluiDex 架构介绍"},"fields":{"slug":"/zh/blog/fluidex-architecture/"}}},"pageContext":{"slug":"/zh/blog/introducing-plonkit/","prevSlug":null,"nextSlug":"/zh/blog/fluidex-architecture/","langKey":"zh"}},"staticQueryHashes":["2555585279","2841359383","3159585216"]}